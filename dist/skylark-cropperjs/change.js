/**
 * skylark-cropperjs - A version of cropperjs that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-cropperjs/
 * @license MIT
 */
define(["./constants","./utilities"],function(T,e){"use strict";return{change(O){const{options:t,canvasData:i,containerData:_,cropBoxData:A,pointers:N}=this;let{action:a}=this,{aspectRatio:s}=t,{left:C,top:I,width:S,height:h}=A;const r=C+S,y=I+h;let x,c=0,E=0,o=_.width,H=_.height,n=!0;!s&&O.shiftKey&&(s=S&&h?S/h:1),this.limited&&(({minLeft:c,minTop:E}=A),o=c+Math.min(_.width,i.width,i.left+i.width),H=E+Math.min(_.height,i.height,i.top+i.height));const b=N[Object.keys(N)[0]],f={x:b.endX-b.startX,y:b.endY-b.startY},k=e=>{switch(e){case T.ACTION_EAST:r+f.x>o&&(f.x=o-r);break;case T.ACTION_WEST:C+f.x<c&&(f.x=c-C);break;case T.ACTION_NORTH:I+f.y<E&&(f.y=E-I);break;case T.ACTION_SOUTH:y+f.y>H&&(f.y=H-y)}};switch(a){case T.ACTION_ALL:C+=f.x,I+=f.y;break;case T.ACTION_EAST:if(f.x>=0&&(r>=o||s&&(I<=E||y>=H))){n=!1;break}k(T.ACTION_EAST),(S+=f.x)<0&&(a=T.ACTION_WEST,C-=S=-S),s&&(h=S/s,I+=(A.height-h)/2);break;case T.ACTION_NORTH:if(f.y<=0&&(I<=E||s&&(C<=c||r>=o))){n=!1;break}k(T.ACTION_NORTH),h-=f.y,I+=f.y,h<0&&(a=T.ACTION_SOUTH,I-=h=-h),s&&(S=h*s,C+=(A.width-S)/2);break;case T.ACTION_WEST:if(f.x<=0&&(C<=c||s&&(I<=E||y>=H))){n=!1;break}k(T.ACTION_WEST),S-=f.x,C+=f.x,S<0&&(a=T.ACTION_EAST,C-=S=-S),s&&(h=S/s,I+=(A.height-h)/2);break;case T.ACTION_SOUTH:if(f.y>=0&&(y>=H||s&&(C<=c||r>=o))){n=!1;break}k(T.ACTION_SOUTH),(h+=f.y)<0&&(a=T.ACTION_NORTH,I-=h=-h),s&&(S=h*s,C+=(A.width-S)/2);break;case T.ACTION_NORTH_EAST:if(s){if(f.y<=0&&(I<=E||r>=o)){n=!1;break}k(T.ACTION_NORTH),h-=f.y,I+=f.y,S=h*s}else k(T.ACTION_NORTH),k(T.ACTION_EAST),f.x>=0?r<o?S+=f.x:f.y<=0&&I<=E&&(n=!1):S+=f.x,f.y<=0?I>E&&(h-=f.y,I+=f.y):(h-=f.y,I+=f.y);S<0&&h<0?(a=T.ACTION_SOUTH_WEST,I-=h=-h,C-=S=-S):S<0?(a=T.ACTION_NORTH_WEST,C-=S=-S):h<0&&(a=T.ACTION_SOUTH_EAST,I-=h=-h);break;case T.ACTION_NORTH_WEST:if(s){if(f.y<=0&&(I<=E||C<=c)){n=!1;break}k(T.ACTION_NORTH),h-=f.y,I+=f.y,S=h*s,C+=A.width-S}else k(T.ACTION_NORTH),k(T.ACTION_WEST),f.x<=0?C>c?(S-=f.x,C+=f.x):f.y<=0&&I<=E&&(n=!1):(S-=f.x,C+=f.x),f.y<=0?I>E&&(h-=f.y,I+=f.y):(h-=f.y,I+=f.y);S<0&&h<0?(a=T.ACTION_SOUTH_EAST,I-=h=-h,C-=S=-S):S<0?(a=T.ACTION_NORTH_EAST,C-=S=-S):h<0&&(a=T.ACTION_SOUTH_WEST,I-=h=-h);break;case T.ACTION_SOUTH_WEST:if(s){if(f.x<=0&&(C<=c||y>=H)){n=!1;break}k(T.ACTION_WEST),S-=f.x,C+=f.x,h=S/s}else k(T.ACTION_SOUTH),k(T.ACTION_WEST),f.x<=0?C>c?(S-=f.x,C+=f.x):f.y>=0&&y>=H&&(n=!1):(S-=f.x,C+=f.x),f.y>=0?y<H&&(h+=f.y):h+=f.y;S<0&&h<0?(a=T.ACTION_NORTH_EAST,I-=h=-h,C-=S=-S):S<0?(a=T.ACTION_SOUTH_EAST,C-=S=-S):h<0&&(a=T.ACTION_NORTH_WEST,I-=h=-h);break;case T.ACTION_SOUTH_EAST:if(s){if(f.x>=0&&(r>=o||y>=H)){n=!1;break}k(T.ACTION_EAST),h=(S+=f.x)/s}else k(T.ACTION_SOUTH),k(T.ACTION_EAST),f.x>=0?r<o?S+=f.x:f.y>=0&&y>=H&&(n=!1):S+=f.x,f.y>=0?y<H&&(h+=f.y):h+=f.y;S<0&&h<0?(a=T.ACTION_NORTH_WEST,I-=h=-h,C-=S=-S):S<0?(a=T.ACTION_SOUTH_WEST,C-=S=-S):h<0&&(a=T.ACTION_NORTH_EAST,I-=h=-h);break;case T.ACTION_MOVE:this.move(f.x,f.y),n=!1;break;case T.ACTION_ZOOM:this.zoom(e.getMaxZoomRatio(N),O),n=!1;break;case T.ACTION_CROP:if(!f.x||!f.y){n=!1;break}x=e.getOffset(this.cropper),C=b.startX-x.left,I=b.startY-x.top,S=A.minWidth,h=A.minHeight,f.x>0?a=f.y>0?T.ACTION_SOUTH_EAST:T.ACTION_NORTH_EAST:f.x<0&&(C-=S,a=f.y>0?T.ACTION_SOUTH_WEST:T.ACTION_NORTH_WEST),f.y<0&&(I-=h),this.cropped||(e.removeClass(this.cropBox,T.CLASS_HIDDEN),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}n&&(A.width=S,A.height=h,A.left=C,A.top=I,this.action=a,this.renderCropBox()),e.forEach(N,T=>{T.startX=T.endX,T.startY=T.endY})}}});
//# sourceMappingURL=sourcemaps/change.js.map
